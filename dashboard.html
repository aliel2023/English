<!DOCTYPE html>
<html lang="az">

<head>
    <!-- KÄ°BER TÆHLÃœKÆSÄ°ZLÄ°K QATI (Security Enforcements) -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://apis.google.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: https:; connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://script.google.com https://script.googleusercontent.com https://generativelanguage.googleapis.com; frame-src 'self'; object-src 'none'; base-uri 'self';">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Clickjacking / Iframe QorumasÄ± (Framebusting) -->
    <style id="antiClickjack">body{display:none !important;}</style>
    <script>
        if (self === top) {
            var antiClickjack = document.getElementById("antiClickjack");
            if (antiClickjack) antiClickjack.parentNode.removeChild(antiClickjack);
        } else {
            top.location = self.location;
        }
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Istifad?çi paneli - Alielenglish">
    <title>Dashboard - Alielenglish</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&subset=latin,latin-ext&display=swap">
    <link rel="stylesheet" href="styles/design-system.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/auth.css">
    <link rel="stylesheet" href="styles/dashboard.css">
    <script>
        // Firebase Auth event-? ?saslanir — localStorage sistemi ARTIQ ISTIFAD? EDILMIR
        // auth.js 'alielAuthReady' event gönd?r?nd? dashboard.js is? düsür
        // Bu blok yalniz ilkin loading state göst?rir
        window.addEventListener('DOMContentLoaded', function () {
            // Auth yükl?n?n? q?d?r h?r ikisini gizl?
            var content = document.getElementById('dashContent');
            var authRequired = document.getElementById('dashAuthRequired');
            if (content) content.classList.add('hidden');
            if (authRequired) authRequired.classList.add('hidden');
        });
    </script>
</head>

<body>
    <!-- Header -->
    <header class="site-header">
        <nav class="main-nav">
            <div class="nav-container">
                <div class="logo-section">
                    <div class="logo"><span class="logo-icon">A</span></div>
                    <span class="brand-name">Alielenglish</span>
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="index.html" data-i18n="nav.home">Ana S?hif?</a></li>
                    <li><a href="daily-word.html">Günün Sözü</a></li>
                    <li><a href="test.html">S?viyy? Testi</a></li>
                    <li><a href="dashboard.html" class="active">?? Dashboard</a></li>
                </ul>
                <div class="nav-actions">
                    <div class="lang-dropdown nav-item">
                        <button class="lang-btn current-lang" id="currentLangBtn"
                            onclick="toggleLangDropdown()">AZ</button>
                        <div class="lang-menu" id="langMenu">
                            <button class="lang-option" onclick="switchLanguage('az', event)">AZ</button>
                            <button class="lang-option" onclick="switchLanguage('en', event)">EN</button>
                        </div>
                    </div>
                    <button class="mobile-toggle" onclick="toggleMobileMenu()">
                        <span></span><span></span><span></span>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Auth Required -->
    <div id="dashAuthRequired" class="auth-required-dash hidden">
        <div class="container">
            <div class="auth-prompt-center">
                <div style="font-size:5rem;">??</div>
                <h2>Hesabiniza Daxil Olun</h2>
                <p>Dashboard-i görm?k üçün hesabiniza daxil olun</p>
                <a href="login.html?next=dashboard.html" class="btn btn-primary">Daxil Ol</a>
                <a href="register.html" class="btn btn-secondary" style="margin-left:1rem;">Qeydiyyat</a>
            </div>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div id="dashContent" class="hidden">

        <!-- Welcome Header -->
        <section class="dash-hero">
            <div class="container">
                <div class="dash-hero-inner">
                    <div class="dash-welcome">
                        <div class="dash-avatar" id="dashAvatar">A</div>
                        <div>
                            <h1 id="dashGreeting">Xos g?ldiniz!</h1>
                            <p id="dashSubtitle" class="dash-subtitle"></p>
                        </div>
                    </div>
                    <div class="dash-streak-card" id="dashStreakCard">
                        <div class="streak-fire">??</div>
                        <div class="streak-number" id="dashStreakNum">0</div>
                        <div class="streak-label">Günlük Sira</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Grid -->
        <section class="dash-stats-section">
            <div class="container">
                <div class="dash-stats-grid">
                    <div class="dash-stat-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statWords">0</div>
                        <div class="dash-stat-label">Öyr?nilmis Söz</div>
                    </div>
                    <div class="dash-stat-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statTests">0</div>
                        <div class="dash-stat-label">Test Sayi</div>
                    </div>
                    <div class="dash-stat-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statDays">0</div>
                        <div class="dash-stat-label">Aktiv Gün</div>
                    </div>
                    <div class="dash-stat-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statFavs">0</div>
                        <div class="dash-stat-label">Sevimli Söz</div>
                    </div>
                    <div class="dash-stat-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statStreak">0</div>
                        <div class="dash-stat-label">?n Uzun Sira</div>
                    </div>
                    <div class="dash-stat-card primary-card">
                        <div class="dash-stat-icon">??</div>
                        <div class="dash-stat-num" id="statLevel">A1</div>
                        <div class="dash-stat-label">Cari S?viyy?</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Daily Tip -->
        <section class="dash-section">
            <div class="container">
                <div class="dash-tip-card" id="dashTipCard">
                    <div class="dash-tip-icon" id="dashTipIcon">??</div>
                    <div class="dash-tip-content">
                        <h3 id="dashTipTitle">Gün M?sl?h?ti</h3>
                        <p id="dashTipText">Yükl?nir...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Weekly Progress -->
        <section class="dash-section">
            <div class="container">
                <h2 class="dash-section-title">?? H?ft?lik Aktivlik</h2>
                <div class="weekly-progress-card">
                    <div class="weekly-days" id="weeklyDays"></div>
                    <div class="weekly-goal">
                        <span>H?ft?lik H?d?f: </span>
                        <span id="weeklyGoalText">0/7 gün</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Badges -->
        <section class="dash-section">
            <div class="container">
                <h2 class="dash-section-title">?? Nailiyy?tl?r</h2>
                <div class="badges-grid" id="badgesGrid"></div>
            </div>
        </section>

        <!-- Test History -->
        <section class="dash-section">
            <div class="container">
                <h2 class="dash-section-title">?? Test Tarixç?si</h2>
                <div id="testHistoryContent">
                    <div class="empty-state">H?l? heç bir test tamamlanmayib. <a href="test.html"
                            class="link-primary">Testi baslayin ?</a></div>
                </div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="dash-section">
            <div class="container">
                <h2 class="dash-section-title">? Sür?tli Keçidl?r</h2>
                <div class="quick-actions-grid">
                    <a href="daily-word.html" class="quick-action-card">
                        <span class="qa-icon">??</span>
                        <div>
                            <strong>Günün Sözü</strong>
                            <p>Yeni söz öyr?n</p>
                        </div>
                    </a>
                    <a href="test.html" class="quick-action-card">
                        <span class="qa-icon">??</span>
                        <div>
                            <strong>S?viyy? Testi</strong>
                            <p>Bilikini yoxla</p>
                        </div>
                    </a>
                    <a href="speaking.html" class="quick-action-card">
                        <span class="qa-icon">???</span>
                        <div>
                            <strong>Danisiq</strong>
                            <p>T?l?ffüzü inkisaf etdir</p>
                        </div>
                    </a>
                    <a href="favorites.html" class="quick-action-card">
                        <span class="qa-icon">??</span>
                        <div>
                            <strong>Sevimlil?r</strong>
                            <p>Öyr?ndikl?rini t?krar et</p>
                        </div>
                    </a>
                </div>
            </div>
        </section>

        <!-- Account Info -->
        <section class="dash-section">
            <div class="container">
                <div class="account-card">
                    <h2>?? Hesab M?lumatlari</h2>
                    <div class="account-info-grid" id="accountInfoGrid"></div>
                    <button class="btn btn-secondary logout-dash-btn" onclick="logoutUser()">?? Hesabdan Çix</button>
                </div>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-bottom">
                <p>© 2025 Alielenglish. Bütün hüquqlar qorunur.</p>
            </div>
        </div>
    </footer>

    <script src="scripts/design-system.js"></script>
    <script src="scripts/i18n.js"></script>
    <script src="scripts/main.js"></script>
    <script type="module" src="scripts/auth.js"></script>
    <script src="scripts/dashboard.js"></script>
</body>

</html>
